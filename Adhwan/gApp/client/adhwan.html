<script>

  class Pane {
    constructor(id) {
      this.id = id;
    }
    get pane() {
      let pane = document.querySelector(`#${this.id}`);
      return pane;
    }
    set contents(html) {
      this.html = html;
      this.render();
    }
    set status(msg) {
      document.querySelector(`#${this.id} .pane-message`).innerHTML = msg;
    }
    update(data) {
      this.status = 'loading';
      function wrap(tag, str) { 
        return `<${tag}>${str}<${'/'}${tag}>`; 
      }
      let [head, ...body] = data;
      let theads = wrap('tr', head.map(h => {
        return `<th scope="col">${h}</th>`; 
      }).join(''));
      let trows = body.map(x => {
        return wrap('tr', x.map(y => {
          return wrap('td', y);
        }).join(''));
      }).join('');
      let html = `<table id="lexicalEntries">
          <thead>
            ${theads}
          </thead>
          <tbody>
            ${trows}
          </tbody>
        </table>`;
      this.contents = html;
      this.data = data; 
    }
    render() {
      let contents = this.html;
      let target = document.querySelector(`#${this.id} .pane-content`);
      target.innerHTML = contents;
      this.status = 'done';
      let status = this.status; 
    }
    load() {
      this.status = ". . .";
      const update = (words) => this.update(words);
      google.script.run
        .withSuccessHandler(update)
        .withFailureHandler(function (err) {
          alert(`Server call failed! ${err}`);
          console.log(err); 
        })
        .getWords();
    }
  }

  const Lexicon = new Pane("lexicon");
  Lexicon.load();
</script>